<div id="sidebar">
  <header>
    <div class="profile-image">
      <% if user_signed_in? && current_user.avatar.attached? %>
        <%= image_tag current_user.avatar, alt: "Profile photo", class: "profile-photo" %>
        <div class="profile-edit-overlay">
          <%= link_to "#", class: "edit-avatar-btn" do %>
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
              <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
            </svg>
          <% end %>
        </div>
      <% elsif user_signed_in? %>
        <div class="profile-placeholder">
          <span>AT</span>
          <div class="profile-edit-overlay">
            <%= link_to "#", class: "edit-avatar-btn" do %>
              <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
              </svg>
            <% end %>
          </div>
        </div>
      <% else %>
        <div class="profile-placeholder">
          <span>AT</span>
        </div>
      <% end %>
    </div>

    <h1 class="site-title animated">
      <%= link_to root_path do %>
        <span class="typing-line line1">
          <span>A</span><span>r</span><span>m</span><span>a</span><span>a</span><span>n</span>
        </span>
        <span class="typing-line line2">
          <span>T</span><span>o</span><span>r</span><span>n</span><span>o</span><span>w</span>
        </span>
      <% end %>
    </h1>
    <p class="lead">My thoughts on tech, life, and everything in between.</p>
  </header>

  <nav id="sidebar-nav-links">
    <%= link_to "posts", root_path, class: "category-link #{'active' if current_page?(root_path)}" %>
    <%= link_to "whoami", "#", class: "page-link" %>
    <%= link_to "tools", "#", class: "page-link" %>
    <%= link_to "topics", "#", class: "page-link" %>
    
    <% if user_signed_in? %>
      <%= link_to "new post", new_thought_path, class: "page-link admin-link" %>
      <%= link_to "logout", destroy_user_session_path, 
          data: { "turbo-method": :delete }, 
          class: "page-link admin-link" %>
    <% else %>
      <%= link_to "login", new_user_session_path, class: "page-link" %>
    <% end %>
  </nav>

  <nav id="sidebar-icon-links">
    <a id="tags-link" class="icon" title="Tags" aria-label="Tags" href="#">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
        <path d="M0 0h24v24H0z" fill="none"></path>
        <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"></path>
      </svg>
    </a>

    <a id="search-link" class="icon" title="Search" aria-label="Search" href="#">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
        <path d="M0 0h24v24H0z" fill="none"></path>
      </svg>
    </a>
  </nav>

  <p class="copyright-text">
    Â© 2025 Armaan Tornow.
  </p>

  <!-- Avatar Upload Modal (Hidden by default) -->
  <% if user_signed_in? %>
    <div id="avatar-upload" class="avatar-modal-backdrop" style="display: none;">
      <div class="avatar-upload-form">
        <%= form_with model: current_user, url: update_avatar_path, method: :patch, local: true, multipart: true, class: "avatar-form" do |form| %>
          <div class="avatar-upload-content">
            <h3>Update Profile Photo</h3>
            <div class="file-input-wrapper">
              <%= form.file_field :avatar, accept: "image/*", class: "avatar-file-input", id: "avatar-input" %>
              <label for="avatar-input" class="file-input-label">
                <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                  <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                  <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
                </svg>
                Choose Photo
              </label>
            </div>
            <div class="avatar-form-actions">
              <%= form.submit "Update Photo", class: "btn btn-primary btn-small" %>
              <button type="button" class="btn btn-secondary btn-small cancel-avatar-btn">Cancel</button>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  <% end %>
</div> 